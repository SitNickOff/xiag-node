(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{55:function(e,t,n){e.exports=n(90)},85:function(e,t,n){},86:function(e,t,n){},90:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),s=n(32),o=n.n(s),c=n(15),l=n(20),i=n(26),u=n(49),p=n.n(u),d=n(50),m=n(51),h=n.n(m),f=n(7),E=n(13),v=n(28),g=n.n(v),b="WS_CREATE_CONNECTION";var w="WS_ONOPEN";var y="WS_ONCLOSE";var _="WS_ONMESSAGE";var O="WS_SEND_MESSAGE";var N="QUESTIONS_REQUEST";function q(){return{type:N}}var A="QUESTIONS_GET";function j(e){return function(t){return t(q()),g.a.get("http://localhost:5000/api/").then(function(e){return e.data}).then(function(n){t({type:A,questions:n,answer:n}),e&&e()}).catch(function(e){return console.log(e.message)})}}var S="QUESTION_GET";function k(e,t){return function(n){return n(q()),g.a.get("http://localhost:5000/api/".concat(e,"/get")).then(function(e){return e.data}).then(function(e){n({type:S,question:e,answer:e}),t&&t()}).catch(function(e){return alert(e.message)})}}var C="QUESTION_CREATE";var x="QUESTION_UPDATE";function T(e,t){return function(n){var a=e._id;return delete e._id,g.a.post("http://localhost:5000/api/".concat(a,"/update"),e).then(function(e){return e.data}).then(function(r){n({type:x,question:e,answer:r}),t&&t(a)}).catch(function(e){return console.log(e.message)})}}var Q="QUESTION_DELETE";var R="QUESTIONS_ADD_RESPONSE";function P(e,t){return function(n){var a=Object(f.a)({},e,{respondentsAnswers:[].concat(Object(E.a)(e.respondentsAnswers),[t])});console.log({question:e,changedQuestionToServer:a});var r=Object(f.a)({},t,{isMine:!0}),s=Object(f.a)({},e,{respondentsAnswers:[].concat(Object(E.a)(e.respondentsAnswers),[r])});console.log({question:e,changedQuestionToServer:a}),n(k(e._id,function(){n(T(a,function(){var e;console.log({changedQuestionToServer:a}),n((e=a,function(t){t({type:O,message:e})})),n({type:R,question:s,resp:t})}))}))}}var I="USER_ADD";var D=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case S:var n=e.find(function(e){return e._id===t.question._id});return void 0===n?[].concat(Object(E.a)(e),[t.question]):e.map(function(e){return e._id===n?Object(f.a)({},e,{respondentsAnswers:e.respondentsAnswers.map(function(e,t){return n.respondentsAnswers[t]&&n.respondentsAnswers[t].isMine?Object(f.a)({},n.respondentsAnswers[t]):e})}):e});case A:return t.questions.map(function(t){if(!t.answers)return Object(f.a)({},t,{answers:[],respondentsAnswers:[]});var n=e.find(function(e){return e._id===t._id});return void 0===n?t:Object(f.a)({},t,{respondentsAnswers:t.respondentsAnswers.map(function(e,t){return n.respondentsAnswers[t]&&n.respondentsAnswers[t].isMine?Object(f.a)({},n.respondentsAnswers[t]):e})})});case C:return[].concat(Object(E.a)(e),[Object(f.a)({},t.question,{_id:e.length+1})]);case x:return e.map(function(e){return e._id===t.question._id?t.question:e});case R:return e.map(function(e){return e._id===t.question._id?t.question:e});default:return e}};var U=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];switch((arguments.length>1?arguments[1]:void 0).type){case N:return!0;case S:case A:return!1;default:return e}},G={name:""};var F=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:G,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case I:return Object(f.a)({},e,{name:t.userName});default:return e}};var M=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case b:return t.ws;case O:return e.send(JSON.stringify(t.message)),e;default:return e}},W=Object(i.c)({questions:D,user:F,ws:M,fetching:U});var J,B;J=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"state";try{var t=localStorage.getItem(e);return null===t?void 0:JSON.parse(t)}catch(n){return}}();var L=Object(i.d)(W,J,Object(i.a)(p.a,d.a,function(e){return function(t){return function(n){var a=t(n),r=e.getState();try{var s=JSON.stringify(B?r[B]:r);localStorage.setItem(B||"state",s)}catch(o){console.error(o)}return a}}},h.a)),X=(n(85),n(86),n(24)),V=n(52);var Y=function(e){var t=e.children,n=Object(V.a)(e,["children"]);return r.a.createElement(c.b,Object.assign({activeClassName:"button--active"},n),t)},$=n(100),z=Object($.a)(function(e){return{root:{},link:{margin:"0 8px"}}})(function(e){var t=e.classes;return r.a.createElement("nav",{className:t.root},r.a.createElement(Y,{to:"/",className:t.link},"New Poll"),r.a.createElement(Y,{to:"/poll",className:t.link},"All Polls"),r.a.createElement("a",{className:t.link,href:"https://test-task.xiag.ch/fullstack-developer.html",target:"_blank",rel:"noopener noreferrer"},"Test Task"))}),H=function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"page__header"},r.a.createElement("div",{className:"page__logo"},r.a.createElement("a",{href:"https://www.xiag.ch",target:"_blank",rel:"noopener noreferrer"},r.a.createElement("img",{src:"https://test-task.xiag.ch/images/page-logo.png",alt:"XIAG AG"}))),r.a.createElement(z,null)),r.a.createElement("div",{className:"page__image"},r.a.createElement("div",{className:"page__task-title"},"Poll website task")))},K=n(34),Z=n.n(K),ee=function(e){return r.a.createElement("div",{className:Z()("page__content","page__content--padding")},e.children)},te=n(18),ne=n(11),ae=n(21),re=n(19),se=n(22),oe=function(e){function t(){return Object(te.a)(this,t),Object(ae.a)(this,Object(re.a)(t).apply(this,arguments))}return Object(se.a)(t,e),Object(ne.a)(t,[{key:"componentDidMount",value:function(){this.props.questionsGet()}},{key:"render",value:function(){var e=this.props,t=e.questions,n=e.history,a=e.questionDelete;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{display:"flex",marginBottom:16}},r.a.createElement("h2",{style:{marginRight:"auto"}},"Question List"),r.a.createElement("div",{className:"ex2-question__submit"},r.a.createElement("button",{className:"btn",onClick:function(){return n.push("/")}},"Add Question"))),r.a.createElement("table",{className:"ex2-table"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"Number"),r.a.createElement("th",null,"Question"),r.a.createElement("th",null,"Actions"))),r.a.createElement("tbody",null,t.map(function(e,t){return r.a.createElement("tr",{key:t},r.a.createElement("td",null,t+1),r.a.createElement("td",null,e.content),r.a.createElement("td",{style:{display:"flex",justifyContent:"space-between"}},r.a.createElement(Y,{to:"/poll/".concat(e._id)},"View"),r.a.createElement(Y,{to:"/poll/".concat(e._id,"/edit")},"Edit"),r.a.createElement(Y,{to:"/poll",onClick:function(){return a(e._id)}},"Delete")))}))))}}]),t}(r.a.Component);var ce=Object(l.b)(function(e){return{questions:e.questions}},function(e){return{questionsGet:function(){return e(j())},questionDelete:function(t){return e((n=t,function(e){return g.a.post("http://localhost:5000/api/".concat(n,"/delete")).then(function(e){return e.data}).then(function(t){e({type:Q,questionId:n,answer:t}),e(j())}).catch(function(e){return console.log(e.message)})}));var n}}})(oe),le=Object(X.f)(ce),ie=function(e){return r.a.createElement("div",{className:"poll"},r.a.createElement(le,null))},ue=function(e){function t(){var e,n;Object(te.a)(this,t);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(n=Object(ae.a)(this,(e=Object(re.a)(t)).call.apply(e,[this].concat(r)))).state={respondent:n.props.user.name,answer:""},n.handleChangeResponden=function(e){n.setState({respondent:e.target.value})},n.handleSelectAnswer=function(e){n.setState({answer:e.target.value})},n.handleSendResponse=function(){""!==n.state.respondent&&""!==n.state.answer?(n.props.userAdd(n.state.respondent),n.props.addResponse(n.props.question,n.state)):alert("Fill All Fields")},n}return Object(se.a)(t,e),Object(ne.a)(t,[{key:"render",value:function(){var e=this,t=this.props.question;return r.a.createElement("div",{className:"ex2-question"},r.a.createElement("div",{className:"ex2-question__label"},"Your name:"),r.a.createElement("div",{className:"ex2-question__input"},r.a.createElement("input",{type:"text",className:"input-text",value:this.state.respondent,onChange:this.handleChangeResponden,placeholder:"insert your name"})),r.a.createElement("div",{className:"ex2-question__answer",style:{display:"flex",flexDirection:"column"}},t.answers.map(function(t,n){return r.a.createElement("label",{key:n},r.a.createElement("input",{type:"radio",name:"do-we-go",value:t,onChange:e.handleSelectAnswer}),t)})),r.a.createElement("div",{style:{display:"flex"}},r.a.createElement("div",{className:"ex2-question__submit"},r.a.createElement("input",{type:"submit",className:"btn",value:"Submit",onClick:this.handleSendResponse}))))}}]),t}(r.a.Component),pe=function(e){var t=e.question;e.user;return r.a.createElement("div",null,r.a.createElement("h3",null,"Results"),r.a.createElement("table",{className:"ex2-table",style:{marginTop:16}},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"Name"),t.answers.map(function(e,t){return r.a.createElement("th",{key:t},e)}))),r.a.createElement("tbody",null,t.respondentsAnswers.map(function(e,n){return r.a.createElement("tr",{key:n,style:{background:e.isMine?"rgb(248, 155, 28, .2)":"inherit"}},r.a.createElement("td",null,e.respondent),t.answers.map(function(t,n){return r.a.createElement("td",{key:n},t===e.answer?"X":"")}))}))))},de=function(e){function t(){return Object(te.a)(this,t),Object(ae.a)(this,Object(re.a)(t).apply(this,arguments))}return Object(se.a)(t,e),Object(ne.a)(t,[{key:"componentDidMount",value:function(){this.props.questionGet(this.props.match.params.id)}},{key:"render",value:function(){var e=this.props,t=e.question,n=e.history,a=e.addResponse,s=e.userAdd,o=e.user;return e.fetching||!t?r.a.createElement("h2",null,"Loading ..."):r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{display:"flex"}},r.a.createElement("h2",{style:{marginRight:"auto"}},t.content),r.a.createElement("div",{className:"ex2-question__submit"},r.a.createElement("button",{className:"btn",onClick:function(){return n.push("/poll")}},"All Polls"))),void 0===t.respondentsAnswers.find(function(e){return e.isMine})&&r.a.createElement(ue,{question:t,user:o,addResponse:a,userAdd:s}),r.a.createElement(pe,{question:t,user:o}))}}]),t}(r.a.Component);var me=Object(l.b)(function(e,t){return{question:e.questions.find(function(e){return e._id===t.match.params.id}),user:e.user,fetching:e.fetching}},function(e){return{addResponse:function(t,n){return e(P(t,n))},userAdd:function(t){return e(function(e){return function(t){t({type:I,userName:e})}}(t))},questionsGet:function(){return e(j())},questionGet:function(t){return e(k(t))}}})(de),he=Object(X.f)(me),fe=function(){return r.a.createElement("div",{className:"poll"},r.a.createElement(he,null))},Ee=function(e){function t(){var e,n;Object(te.a)(this,t);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(n=Object(ae.a)(this,(e=Object(re.a)(t)).call.apply(e,[this].concat(r)))).state={_id:n.props.question?n.props.question._id:0,content:n.props.question?n.props.question.content:"",answers:n.props.question?n.props.question.answers:["",""],respondentsAnswers:n.props.question?n.props.question.respondentsAnswers:[]},n.handleChangeContent=function(e){n.setState({content:e.target.value})},n.handleAddAnswer=function(){n.setState({answers:[].concat(Object(E.a)(n.state.answers),[""])})},n.handleChangeAnswer=function(e){return function(t){n.setState({answers:n.state.answers.map(function(n,a){return a===e?t.target.value:n})})}},n.redirectToPollPage=function(e){return n.props.history.push("/poll/".concat(e))},n.redirectToPageAllQuestions=function(){return n.props.history.push("/poll")},n.addQuestionChanges=function(){var e=!0;""===n.state.content&&(e=!1),n.state.answers.forEach(function(t){""===t&&(e=!1)}),e?0===n.state._id?n.props.questionCreate(n.state,n.redirectToPollPage):n.props.questionUpdate(n.state,n.redirectToPollPage):alert("Fill All Fields")},n}return Object(se.a)(t,e),Object(ne.a)(t,[{key:"render",value:function(){var e=this,t=this.props.history,n=this.state;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{display:"flex",marginBottom:16}},r.a.createElement("h2",{style:{marginRight:"auto"}},n?"Edit Question":"New Question"),r.a.createElement("div",{className:"ex2-question__submit"},r.a.createElement("button",{className:"btn",onClick:function(){return t.push("/poll")}},"All Polls"))),r.a.createElement("table",{className:"poll-table"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"Question:"),r.a.createElement("th",null,r.a.createElement("input",{type:"text",value:n?n.content:"",className:"input-text",placeholder:"Enter a question",onChange:this.handleChangeContent})))),r.a.createElement("tbody",null,n.answers.map(function(t,n){return r.a.createElement("tr",{key:n},r.a.createElement("th",null,"Answer ".concat(n+1,":")),r.a.createElement("td",null,r.a.createElement("input",{type:"text",value:t,placeholder:"Enter an option",onChange:e.handleChangeAnswer(n),className:"input-text"})))}),r.a.createElement("tr",null,r.a.createElement("td",{className:"poll-table__plus"},r.a.createElement("button",{className:Z()("btn","btn--plus"),onClick:this.handleAddAnswer},"+")),r.a.createElement("td",null," ")))),r.a.createElement("button",{className:"btn btn--start",onClick:this.addQuestionChanges},n._id?"Change":"Start"))}}]),t}(r.a.Component);var ve=Object(l.b)(function(e,t){return{question:e.questions.find(function(e){return e._id===t.match.params.id})}},function(e){return{questionCreate:function(t,n){return e(function(e,t){return function(n){return delete e._id,g.a.post("http://localhost:5000/api/create",e).then(function(e){return e.data}).then(function(a){n({type:C,question:Object(f.a)({},e,{_id:a.insertedId,answer:a})}),t&&t(a.insertedId)}).catch(function(e){return console.log(e.message)})}}(t,n))},questionUpdate:function(t,n){return e(T(t,n))}}})(Ee),ge=Object(X.f)(ve),be=function(){return r.a.createElement("div",{className:"poll"},r.a.createElement(ge,null))},we=function(){return r.a.createElement("div",{style:{textAlign:"center"}},r.a.createElement("h2",null,"Page Not Found"))},ye=function(e){return r.a.createElement("div",{className:"page"},r.a.createElement(H,null),r.a.createElement(ee,null,r.a.createElement(X.c,null,r.a.createElement(X.a,{exact:!0,path:"/",component:be}),r.a.createElement(X.a,Object.assign({exact:!0,path:"/poll",component:ie},e)),r.a.createElement(X.a,{exact:!0,path:"/poll/:id",component:fe}),r.a.createElement(X.a,{exact:!0,path:"/poll/:id/edit",component:be}),r.a.createElement(X.a,{component:we}))))};L.dispatch(function(e){var t=new WebSocket("ws://localhost:5001");t.onopen=function(){return e(function(e){e({type:w})})},t.onclose=function(){return e(function(e){e({type:y})})},t.onmessage=function(t){return e(function(e){return console.log({message:e}),function(t){t({type:_,message:e}),t(j())}}(t))},e({type:b,ws:t})});var _e=function(){return r.a.createElement(ye,null)};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(l.a,{store:L},r.a.createElement(c.a,null,r.a.createElement(_e,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[55,1,2]]]);
//# sourceMappingURL=main.279fdf29.chunk.js.map