(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{55:function(e,t,n){e.exports=n(90)},85:function(e,t,n){},86:function(e,t,n){},90:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),s=n(32),o=n.n(s),l=n(15),c=n(20),i=n(26),u=n(49),d=n.n(u),p=n(50),m=n(51),h=n.n(m),f=n(13),E=n(11),g=n(31),v=n.n(g),b="WS_CREATE_CONNECTION";var w="WS_ONOPEN";var y="WS_ONCLOSE";var _="WS_ONMESSAGE";var O="WS_SEND_MESSAGE";var N="QUESTIONS_GET";function q(e){return function(t){return v.a.get("http://localhost:5000/api/").then(function(e){return e.data}).then(function(n){t({type:N,questions:n,answer:n}),e&&e()}).catch(function(e){return console.log(e.message)})}}var j="QUESTION_CREATE";var A="QUESTION_UPDATE";function S(e,t){return function(n){var a=e._id;return delete e._id,v.a.post("http://localhost:5000/api/".concat(a,"/update"),e).then(function(e){return e.data}).then(function(r){n({type:A,question:e,answer:r}),t&&t(a)}).catch(function(e){return console.log(e.message)})}}var k="QUESTION_DELETE";var C="QUESTIONS_ADD_RESPONSE";function x(e,t){return function(n){var a=Object(E.a)({},t);delete a.isMine;var r=Object(E.a)({},e,{respondentsAnswers:[].concat(Object(f.a)(e.respondentsAnswers),[a])}),s=Object(E.a)({},e,{respondentsAnswers:[].concat(Object(f.a)(e.respondentsAnswers),[t])});n(q(function(){n(S(r,function(){return n((e=r,function(t){t({type:O,message:e})}));var e})),n({type:C,question:s,resp:t})}))}}var T="USER_ADD";var R=[{_id:1,content:"\u0412\u044b \u0443\u043c\u043d\u044b\u0439?",answers:["\u0414\u0430","\u041d\u0435\u0442"],author:"\u0421\u0438\u0442\u043d\u0438\u043a\u043e\u0432 \u0410.",respondentsAnswers:[{respondent:"\u0421\u0438\u0442\u043d\u0438\u043a\u043e\u0432 \u0410.",answer:"\u0414\u0430"}]},{_id:2,content:"\u041d\u0430 \u0441\u043a\u043e\u043b\u044c\u043a\u043e \u0412\u044b \u043a\u0440\u0430\u0441\u0438\u0432\u044b\u0439?",answers:["\u0421\u0430\u043c\u044b\u0439 \u043a\u0440\u0430\u0441\u0438\u0432\u044b\u0439","\u041e\u0447\u0435\u043d\u044c \u043a\u0440\u0430\u0441\u0438\u0432\u044b\u0439","\u0421\u0438\u043c\u043f\u0430\u0442\u0438\u0447\u043d\u044b\u0439"],author:"\u0421\u0438\u0442\u043d\u0438\u043a\u043e\u0432 \u0410.",respondentsAnswers:[]}];var I=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:R,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case N:return t.questions.map(function(t){if(!t.answers)return Object(E.a)({},t,{answers:[],respondentsAnswers:[]});var n=e.find(function(e){return e._id===t._id});return void 0===n?t:Object(E.a)({},t,{respondentsAnswers:t.respondentsAnswers.map(function(e,t){return n.respondentsAnswers[t]&&n.respondentsAnswers[t].isMine?n.respondentsAnswers[t]:e})})});case j:return[].concat(Object(f.a)(e),[Object(E.a)({},t.question,{_id:e.length+1})]);case A:return e.map(function(e){return e._id===t.question._id?t.question:e});case C:return e.map(function(e){return e._id===t.question._id?t.question:e});default:return e}},P={name:""};var Q=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:P,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case T:return Object(E.a)({},e,{name:t.userName});default:return e}};var D=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case b:return t.ws;case O:return e.send(t.message),e;default:return e}},U=Object(i.c)({questions:I,user:Q,ws:D});var G,M;G=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"state";try{var t=localStorage.getItem(e);return null===t?void 0:JSON.parse(t)}catch(n){return}}();var W=Object(i.d)(U,G,Object(i.a)(d.a,p.a,function(e){return function(t){return function(n){var a=t(n);try{var r=JSON.stringify(M?e.getState()[M]:e.getState());localStorage.setItem(M||"state",r)}catch(s){console.error(s)}return a}}},h.a)),F=(n(85),n(86),n(24)),B=n(52);var J=function(e){var t=e.children,n=Object(B.a)(e,["children"]);return r.a.createElement(l.b,Object.assign({activeClassName:"button--active"},n),t)},L=n(100),X=Object(L.a)(function(e){return{root:{},link:{margin:"0 8px"}}})(function(e){var t=e.classes;return r.a.createElement("nav",{className:t.root},r.a.createElement(J,{to:"/",className:t.link},"Poll"),r.a.createElement("a",{className:t.link,href:"https://test-task.xiag.ch/fullstack-developer.html",target:"_blank",rel:"noopener noreferrer"},"Task"))}),V=function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"page__header"},r.a.createElement("div",{className:"page__logo"},r.a.createElement("a",{href:"https://www.xiag.ch",target:"_blank",rel:"noopener noreferrer"},r.a.createElement("img",{src:"https://test-task.xiag.ch/images/page-logo.png",alt:"XIAG AG"}))),r.a.createElement(X,null)),r.a.createElement("div",{className:"page__image"},r.a.createElement("div",{className:"page__task-title"},"Poll website task")))},Y=n(34),$=n.n(Y),z=function(e){return r.a.createElement("div",{className:$()("page__content","page__content--padding")},e.children)},H=n(18),K=n(10),Z=n(21),ee=n(19),te=n(22),ne=function(e){function t(){return Object(H.a)(this,t),Object(Z.a)(this,Object(ee.a)(t).apply(this,arguments))}return Object(te.a)(t,e),Object(K.a)(t,[{key:"componentDidMount",value:function(){this.props.questionsGet()}},{key:"render",value:function(){var e=this.props,t=e.questions,n=e.history,a=e.questionDelete;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{display:"flex",marginBottom:16}},r.a.createElement("h2",{style:{marginRight:"auto"}},"Question List"),r.a.createElement("div",{className:"ex2-question__submit"},r.a.createElement("button",{className:"btn",onClick:function(){return n.push("/")}},"Add Question"))),r.a.createElement("table",{className:"ex2-table"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"Number"),r.a.createElement("th",null,"Question"),r.a.createElement("th",null,"Actions"))),r.a.createElement("tbody",null,t.map(function(e,t){return r.a.createElement("tr",{key:t},r.a.createElement("td",null,t+1),r.a.createElement("td",null,e.content),r.a.createElement("td",{style:{display:"flex",justifyContent:"space-between"}},r.a.createElement(J,{to:"/poll/".concat(e._id)},"View"),r.a.createElement(J,{to:"/poll/".concat(e._id,"/edit")},"Edit"),r.a.createElement(J,{to:"/poll",onClick:function(){return a(e._id)}},"Delete")))}))))}}]),t}(r.a.Component);var ae=Object(c.b)(function(e){return{questions:e.questions}},function(e){return{questionsGet:function(){return e(q())},questionDelete:function(t){return e((n=t,function(e){return v.a.post("http://localhost:5000/api/".concat(n,"/delete")).then(function(e){return e.data}).then(function(t){e({type:k,questionId:n,answer:t}),e(q())}).catch(function(e){return console.log(e.message)})}));var n}}})(ne),re=Object(F.f)(ae),se=function(e){return r.a.createElement("div",{className:"poll"},r.a.createElement(re,null))},oe=function(e){function t(){var e,n;Object(H.a)(this,t);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(n=Object(Z.a)(this,(e=Object(ee.a)(t)).call.apply(e,[this].concat(r)))).state={respondent:n.props.user.name,answer:"",isMine:!0},n.handleChangeResponden=function(e){n.setState({respondent:e.target.value})},n.handleSelectAnswer=function(e){n.setState({answer:e.target.value})},n.handleSendResponse=function(){""!==n.state.respondent&&""!==n.state.answer?(n.props.userAdd(n.state.respondent),n.props.addResponse(n.props.question,n.state)):console.log("alert: fill all fields")},n}return Object(te.a)(t,e),Object(K.a)(t,[{key:"render",value:function(){var e=this,t=this.props.question;return r.a.createElement("div",{className:"ex2-question"},r.a.createElement("div",{className:"ex2-question__label"},"Your name:"),r.a.createElement("div",{className:"ex2-question__input"},r.a.createElement("input",{type:"text",className:"input-text",value:this.state.respondent,onChange:this.handleChangeResponden,placeholder:"insert your name"})),r.a.createElement("div",{className:"ex2-question__answer",style:{display:"flex",flexDirection:"column"}},t.answers.map(function(t,n){return r.a.createElement("label",{key:n},r.a.createElement("input",{type:"radio",name:"do-we-go",value:t,onChange:e.handleSelectAnswer}),t)})),r.a.createElement("div",{style:{display:"flex"}},r.a.createElement("div",{className:"ex2-question__submit"},r.a.createElement("input",{type:"submit",className:"btn",value:"Submit",onClick:this.handleSendResponse}))))}}]),t}(r.a.Component),le=function(e){var t=e.question;e.user;return r.a.createElement("div",null,r.a.createElement("h3",null,"Results"),r.a.createElement("table",{className:"ex2-table",style:{marginTop:16}},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"Name"),t.answers.map(function(e,t){return r.a.createElement("th",{key:t},e)}))),r.a.createElement("tbody",null,t.respondentsAnswers.map(function(e,n){return r.a.createElement("tr",{key:n,style:{background:e.isMine?"rgb(248, 155, 28, .2)":"inherit"}},r.a.createElement("td",null,e.respondent),t.answers.map(function(t,n){return r.a.createElement("td",{key:n},t===e.answer?"X":"")}))}))))},ce=function(e){function t(){var e,n;Object(H.a)(this,t);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(n=Object(Z.a)(this,(e=Object(ee.a)(t)).call.apply(e,[this].concat(r)))).state={fetching:!0},n}return Object(te.a)(t,e),Object(K.a)(t,[{key:"componentDidMount",value:function(){this.props.questionsGet()}},{key:"componentDidUpdate",value:function(){this.state.fetching&&this.setState({fetching:!1})}},{key:"render",value:function(){var e=this.props,t=e.question,n=e.history,a=e.addResponse,s=e.userAdd,o=e.user,l=this.state.fetching;return console.log({fetching:l,question:t}),this.state.fetching?r.a.createElement("h2",null,"Loading ..."):void 0===t?r.a.createElement("h2",null,"Page Not Found"):r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{display:"flex"}},r.a.createElement("h2",{style:{marginRight:"auto"}},t.content),r.a.createElement("div",{className:"ex2-question__submit"},r.a.createElement("button",{className:"btn",onClick:function(){return n.push("/poll")}},"All Polls"))),void 0===t.respondentsAnswers.find(function(e){return e.isMine})&&r.a.createElement(oe,{question:t,user:o,addResponse:a,userAdd:s}),r.a.createElement(le,{question:t,user:o}))}}]),t}(r.a.Component);var ie=Object(c.b)(function(e,t){return{question:e.questions.find(function(e){return e._id===t.match.params.id}),user:e.user}},function(e){return{addResponse:function(t,n){return e(x(t,n))},userAdd:function(t){return e(function(e){return function(t){t({type:T,userName:e})}}(t))},questionsGet:function(){return e(q())}}})(ce),ue=Object(F.f)(ie),de=function(){return r.a.createElement("div",{className:"poll"},r.a.createElement(ue,null))},pe=function(e){function t(){var e,n;Object(H.a)(this,t);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(n=Object(Z.a)(this,(e=Object(ee.a)(t)).call.apply(e,[this].concat(r)))).state={_id:n.props.question?n.props.question._id:0,content:n.props.question?n.props.question.content:"",answers:n.props.question?n.props.question.answers:["",""],respondentsAnswers:n.props.question?n.props.question.respondentsAnswers:[]},n.handleChangeContent=function(e){n.setState({content:e.target.value})},n.handleAddAnswer=function(){n.setState({answers:[].concat(Object(f.a)(n.state.answers),[""])})},n.handleChangeAnswer=function(e){return function(t){n.setState({answers:n.state.answers.map(function(n,a){return a===e?t.target.value:n})})}},n.redirectToPollPage=function(e){return n.props.history.push("/poll/".concat(e))},n.redirectToPageAllQuestions=function(){return n.props.history.push("/poll")},n.addQuestionChanges=function(){var e=!0;""===n.state.content&&(e=!1),n.state.answers.forEach(function(t){""===t&&(e=!1)}),e?0===n.state._id?n.props.questionCreate(n.state,n.redirectToPollPage):n.props.questionUpdate(n.state,n.redirectToPollPage):console.log("alert: fill all fields")},n}return Object(te.a)(t,e),Object(K.a)(t,[{key:"render",value:function(){var e=this,t=this.props.history,n=this.state;return console.log({question:n}),r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{display:"flex",marginBottom:16}},r.a.createElement("h2",{style:{marginRight:"auto"}},n?"Edit Question":"New Question"),r.a.createElement("div",{className:"ex2-question__submit"},r.a.createElement("button",{className:"btn",onClick:function(){return t.push("/poll")}},"All Polls"))),r.a.createElement("table",{className:"poll-table"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"Question:"),r.a.createElement("th",null,r.a.createElement("input",{type:"text",value:n?n.content:"",className:"input-text",placeholder:"Insert question",onChange:this.handleChangeContent})))),r.a.createElement("tbody",null,n.answers.map(function(t,n){return r.a.createElement("tr",{key:n},r.a.createElement("th",null,"Answer ".concat(n+1,":")),r.a.createElement("td",null,r.a.createElement("input",{type:"text",value:t,placeholder:"Enter option",onChange:e.handleChangeAnswer(n),className:"input-text"})))}),r.a.createElement("tr",null,r.a.createElement("td",{className:"poll-table__plus"},r.a.createElement("button",{className:$()("btn","btn--plus"),onClick:this.handleAddAnswer},"+")),r.a.createElement("td",null," ")))),r.a.createElement("button",{className:"btn btn--start",onClick:this.addQuestionChanges},n._id?"Change":"Start"))}}]),t}(r.a.Component);var me=Object(c.b)(function(e,t){return{question:e.questions.find(function(e){return e._id===t.match.params.id})}},function(e){return{questionCreate:function(t,n){return e(function(e,t){return function(n){return delete e._id,v.a.post("http://localhost:5000/api/create",e).then(function(e){return e.data}).then(function(a){console.log("QUESTION_CREATE: ",Object(E.a)({},e,{_id:a.insertedId,answer:a})),n({type:j,question:Object(E.a)({},e,{_id:a.insertedId,answer:a})}),t&&t(a.insertedId)}).catch(function(e){return console.log(e.message)})}}(t,n))},questionUpdate:function(t,n){return e(S(t,n))}}})(pe),he=Object(F.f)(me),fe=function(){return r.a.createElement("div",{className:"poll"},r.a.createElement(he,null))},Ee=function(){return r.a.createElement("h1",null,"NotFound")},ge=function(e){return r.a.createElement("div",{className:"page"},r.a.createElement(V,null),r.a.createElement(z,null,r.a.createElement(F.c,null,r.a.createElement(F.a,{exact:!0,path:"/",component:fe}),r.a.createElement(F.a,Object.assign({exact:!0,path:"/poll",component:se},e)),r.a.createElement(F.a,{exact:!0,path:"/poll/:id",component:de}),r.a.createElement(F.a,{exact:!0,path:"/poll/:id/edit",component:fe}),r.a.createElement(F.a,{component:Ee}))))};W.dispatch(function(e){var t=new WebSocket("ws://localhost:5001");t.onopen=function(){return e(function(e){e({type:w})})},t.onclose=function(){return e(function(e){e({type:y})})},t.onmessage=function(t){return e(function(e){return function(t){t({type:_,message:e}),t(q())}}(t))},e({type:b,ws:t})});var ve=function(){return r.a.createElement(ge,null)};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(c.a,{store:W},r.a.createElement(l.a,null,r.a.createElement(ve,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[55,1,2]]]);
//# sourceMappingURL=main.1e91aec5.chunk.js.map